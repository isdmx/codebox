server:
  transport: "http" # or "stdio"
  http_port: 8080

sandbox:
  backend: "docker"
  timeout_sec: 60
  memory_mb: 512
  max_artifact_size_mb: 20
  network_enabled: false
  enable_local_backend: false

languages:
  python:
    image: "python:3.11-slim"
    prefix_code: |
      import signal, sys

      def timeout_handler(signum, frame):
          print('Execution timeout!')
          sys.exit(1)

      signal.signal(signal.SIGALRM, timeout_handler)
      signal.alarm(10)  # Set timeout to 10 seconds

    postfix_code: |
      import sys
      signal.alarm(0)  # Cancel the alarm
      sys.stdout.flush()
      sys.stderr.flush()
    environment:
      PYTHONPATH: "/workdir"
      PYTHONIOENCODING: "utf-8"
    exclude_patterns:
      - "__pycache__/"
      - "*.pyc"
      - "*.pyo"
      - ".pytest_cache/"
      - ".coverage"
      - "htmlcov/"
      - "*.egg-info/"
      - ".tox/"
      - ".nox/"
      - ".git/"
      - ".svn/"
      - ".hg/"
      - "main.py"  # exclude source code
      - "*.o"      # exclude object files
      - "*.so"     # exclude shared objects
      - "*.a"      # exclude archive files

  nodejs:
    image: "node:20-alpine"
    prefix_code: |
      // Set timeout for Node.js execution
      //setTimeout(() => {
      //  console.log('Execution timeout!');
      // process.exit(1);
      //}, 5000);  // 10 seconds
    postfix_code: |
      process.exit(0)
    environment:
      NODE_PATH: "/workdir"
      NODE_ENV: "production"
    exclude_patterns:
      - "node_modules/"
      - "npm-debug.log*"
      - "yarn-debug.log*"
      - "yarn-error.log*"
      - ".npm/"
      - ".yarn/"
      - ".git/"
      - ".svn/"
      - ".hg/"
      - "dist/"
      - "build/"
      - ".next/"
      - ".nuxt/"
      - "coverage/"
      - ".vscode/"
      - ".idea/"
      - "index.js"  # exclude source code
      - "*.js.map"  # exclude source maps
      - "*.out"     # exclude compiled output

  go:
    image: "golang:1.23-alpine"
    build_cmd: "go build -o /workdir/app /workdir/main.go"
    run_cmd: "/workdir/app"
    environment:
      GOCACHE: "/tmp/go-build"
      GOMODCACHE: "/tmp/go-mod"
    exclude_patterns:
      - "*.o"
      - "*.a"
      - "*.so"
      - "*.out"
      - "*.exe"
      - "go.sum"
      - "go.mod"
      - ".git/"
      - ".svn/"
      - ".hg/"
      - "vendor/"
      - "bin/"
      - "pkg/"
      - "target/"
      - ".vscode/"
      - ".idea/"
      - "main.go"     # exclude source code
      - "app"         # exclude built binary
      - "go-build/"   # exclude build cache

  cpp:
    image: "gcc:13"
    build_cmd: "g++ -std=c++17 -O2 -o /workdir/app /workdir/main.cpp"
    run_cmd: "/workdir/app"
    environment:
      LANG: "C.UTF-8"
      LC_ALL: "C.UTF-8"
    exclude_patterns:
      - "*.o"
      - "*.a"
      - "*.so"
      - "*.out"
      - "*.exe"
      - "*.obj"
      - "a.out"
      - "a.exe"
      - "app"         # exclude built binary
      - "main.cpp"    # exclude source code
      - ".git/"
      - ".svn/"
      - ".hg/"
      - "build/"
      - "cmake-build*/"
      - "bin/"
      - "obj/"
      - ".vscode/"
      - ".idea/"
      - "lib/"        # exclude built libraries
      - "*.dylib"     # exclude dylibs (macOS)
      - "*.dll"       # exclude dlls (Windows)
      - "*.so.*"      # exclude versioned shared objects

logging:
  mode: "development" # "production", "development"
  level: "debug" # debug, info, warn, error, dpanic, panic, fatal
